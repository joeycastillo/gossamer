<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>gossamer: common/system.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">gossamer<span id="projectnumber">&#160;0.0.0</span>
   </div>
   <div id="projectbrief">a very lightweight app framework for SAMD and SAML chips</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_bdd9a5d540de89e9fe90efdfc6973a4f.html">common</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">system.h File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Gossamer system routines.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdint.h&gt;</code><br />
<code>#include &lt;stdbool.h&gt;</code><br />
<code>#include &lt;stddef.h&gt;</code><br />
<code>#include &quot;sam.h&quot;</code><br />
</div>
<p><a href="system_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_t_c___instance___details.html">TC_Instance_Details</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_t_c_c___instance___details.html">TCC_Instance_Details</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr><td colspan="2"><div class="groupHeader"></div></td></tr>
<tr class="memitem:af411a8bc6b7ed4b0af9114e10c959448"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="system_8h.html#af411a8bc6b7ed4b0af9114e10c959448">sys_init</a> (void)</td></tr>
<tr class="memdesc:af411a8bc6b7ed4b0af9114e10c959448"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes the system clocks and performs any required system-wide setup.  <a href="system_8h.html#af411a8bc6b7ed4b0af9114e10c959448">More...</a><br /></td></tr>
<tr class="separator:af411a8bc6b7ed4b0af9114e10c959448"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a96fa401b65736262fc29cc0537bed03e"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="system_8h.html#a96fa401b65736262fc29cc0537bed03e">get_cpu_frequency</a> (void)</td></tr>
<tr class="memdesc:a96fa401b65736262fc29cc0537bed03e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the CPU frequency.  <a href="system_8h.html#a96fa401b65736262fc29cc0537bed03e">More...</a><br /></td></tr>
<tr class="separator:a96fa401b65736262fc29cc0537bed03e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f33e5a16dba970fa7064ea27287fcba"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="system_8h.html#a4f33e5a16dba970fa7064ea27287fcba">set_cpu_frequency</a> (uint32_t freq)</td></tr>
<tr class="memdesc:a4f33e5a16dba970fa7064ea27287fcba"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the CPU frequency.  <a href="system_8h.html#a4f33e5a16dba970fa7064ea27287fcba">More...</a><br /></td></tr>
<tr class="separator:a4f33e5a16dba970fa7064ea27287fcba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a436af75ad5caf82faa3497787abf4321"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="system_8h.html#a436af75ad5caf82faa3497787abf4321">_enter_standby_mode</a> (void)</td></tr>
<tr class="memdesc:a436af75ad5caf82faa3497787abf4321"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enters the low-power STANDBY mode. Does not return until an interrupt fires.  <a href="system_8h.html#a436af75ad5caf82faa3497787abf4321">More...</a><br /></td></tr>
<tr class="separator:a436af75ad5caf82faa3497787abf4321"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ad6fe6f458d7566ce5b47ed112801890d"><td class="memItemLeft" align="right" valign="top"><a id="ad6fe6f458d7566ce5b47ed112801890d" name="ad6fe6f458d7566ce5b47ed112801890d"></a>
<a class="el" href="struct_t_c___instance___details.html">TC_Instance_Details</a>&#160;</td><td class="memItemRight" valign="bottom"><b>TC_Peripherals</b> []</td></tr>
<tr class="separator:ad6fe6f458d7566ce5b47ed112801890d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8bf52f6d954ede65ab6b3151dcd719b2"><td class="memItemLeft" align="right" valign="top"><a id="a8bf52f6d954ede65ab6b3151dcd719b2" name="a8bf52f6d954ede65ab6b3151dcd719b2"></a>
uint8_t&#160;</td><td class="memItemRight" valign="bottom"><b>Num_TC_Instances</b></td></tr>
<tr class="separator:a8bf52f6d954ede65ab6b3151dcd719b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a207cf43bde0ae07772ed293da8eaf131"><td class="memItemLeft" align="right" valign="top"><a id="a207cf43bde0ae07772ed293da8eaf131" name="a207cf43bde0ae07772ed293da8eaf131"></a>
uint8_t&#160;</td><td class="memItemRight" valign="bottom"><b>TC_First_Index</b></td></tr>
<tr class="separator:a207cf43bde0ae07772ed293da8eaf131"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e913423cf8628f6efe93c6b2e2afae9"><td class="memItemLeft" align="right" valign="top"><a id="a6e913423cf8628f6efe93c6b2e2afae9" name="a6e913423cf8628f6efe93c6b2e2afae9"></a>
<a class="el" href="struct_t_c_c___instance___details.html">TCC_Instance_Details</a>&#160;</td><td class="memItemRight" valign="bottom"><b>TCC_Peripherals</b> []</td></tr>
<tr class="separator:a6e913423cf8628f6efe93c6b2e2afae9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9d6b1c7d1978c45a6d12b1ab08c6a5c"><td class="memItemLeft" align="right" valign="top"><a id="ad9d6b1c7d1978c45a6d12b1ab08c6a5c" name="ad9d6b1c7d1978c45a6d12b1ab08c6a5c"></a>
uint8_t&#160;</td><td class="memItemRight" valign="bottom"><b>Num_TCC_Instances</b></td></tr>
<tr class="separator:ad9d6b1c7d1978c45a6d12b1ab08c6a5c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >Gossamer system routines. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a436af75ad5caf82faa3497787abf4321" name="a436af75ad5caf82faa3497787abf4321"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a436af75ad5caf82faa3497787abf4321">&#9670;&#160;</a></span>_enter_standby_mode()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void _enter_standby_mode </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Enters the low-power STANDBY mode. Does not return until an interrupt fires. </p>
<p >You should not generally need to call this function; at the end of every app_loop invocation, the main run loop enters standby mode if your app indicated that it was appropriate. </p>

</div>
</div>
<a id="a96fa401b65736262fc29cc0537bed03e" name="a96fa401b65736262fc29cc0537bed03e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a96fa401b65736262fc29cc0537bed03e">&#9670;&#160;</a></span>get_cpu_frequency()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t get_cpu_frequency </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets the CPU frequency. </p>
<dl class="section return"><dt>Returns</dt><dd>8000000 by default, or another value if set by <code>set_cpu_frequency</code> </dd></dl>

</div>
</div>
<a id="a4f33e5a16dba970fa7064ea27287fcba" name="a4f33e5a16dba970fa7064ea27287fcba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4f33e5a16dba970fa7064ea27287fcba">&#9670;&#160;</a></span>set_cpu_frequency()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool set_cpu_frequency </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>freq</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets the CPU frequency. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">freq</td><td>one of 1000000, 2000000, 4000000, 8000000, 12000000 or 16000000.</td></tr>
  </table>
  </dd>
</dl>
<p>Supported CPU frequencies vary from chip to chip:</p><ul>
<li>On the SAM D11 and D21, you can choose 8, 4, 2 or 1 MHz.</li>
<li>On the SAM L21 and L22, you can choose 16, 12, 8 or 4 MHz. While you can run these chips at higher frequencies using the DFLL, Gossamer aims for simplicity: this means that it only supports the internal oscillator at one of its standard frequencies. <dl class="section note"><dt>Note</dt><dd>Some peripherals like SERCOMs and TC/TCCs read the CPU frequency when they are configured, to set critical timing-related parameters like baud rate or period. If you change the CPU frequency after setting up these peripherals and then attempt to use them, they will very likely behave in unexpected ways. Thus you should disable any peripherals that depend on GCLK0 before calling set_cpu_frequency, and then re-enable them after. </dd></dl>
</li>
</ul>

</div>
</div>
<a id="af411a8bc6b7ed4b0af9114e10c959448" name="af411a8bc6b7ed4b0af9114e10c959448"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af411a8bc6b7ed4b0af9114e10c959448">&#9670;&#160;</a></span>sys_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sys_init </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes the system clocks and performs any required system-wide setup. </p>
<p >Gossamer aims for consistency at system startup, no matter which chip you are working with. To that end:</p><ul>
<li>GCLK0, the main system clock, is set to 8 MHz.</li>
<li>GCLK2 is the low-power 32768 Hz clock, OSCULP32K</li>
<li>GCLK3 is a 1024 Hz clock, derived from the most accurate source available. GCLK0 is set to ONDEMAND with RUNSTDBY off, so the main clock remains off when in standby mode. GCLK2 and GCLK3 are also ONDEMAND, but RUNSTDBY is on. This ensures that if a peripheral requests it, the clock will remain on in standby, but if no peripheral requests it, it will not run at all. </li>
</ul>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.5
</small></address>
</body>
</html>
